<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('./partials/head') %>
    <title>Blogify | Home</title>
    <style>
      .hero {
        background: linear-gradient(rgba(0, 0, 0, 0.55), rgba(0, 0, 0, 0.55)),
          url("/images/blog-hero.jpg") center/cover no-repeat;
        color: white;
        padding: 100px 20px;
        text-align: center;
        border-radius: 10px;
      }

      .hero h1 {
        font-size: 3rem;
        font-weight: bold;
        margin-bottom: 20px;
      }

      .hero p {
        font-size: 1.25rem;
        margin-bottom: 30px;
      }

      .btn-get-started {
        font-size: 1rem;
        padding: 10px 25px;
        border-radius: 25px;
      }

      .features {
        padding: 60px 0;
        text-align: center;
      }

      .features h2 {
        font-weight: bold;
        margin-bottom: 40px;
      }

      .feature-box {
        padding: 20px;
      }

      .feature-icon {
        font-size: 2.5rem;
        color: #007bff;
        margin-bottom: 15px;
      }
    </style>
  </head>
  <body>
    <%- include('./partials/nav') %>

    <!-- Hero Section -->
    <section class="hero container mt-4">
      <h1>Welcome to Blogify</h1>
      <p>
        Discover stories, share your ideas, and connect with others on Blogify â€”
        your personal blogging companion.
      </p>
      <% if(user){ %>
      <a href="/addblogs" class="btn btn-primary btn-get-started"
        >Get Started</a
      >
      <% } else{ %>
      <a href="/user/signin" class="btn btn-primary btn-get-started"
        >Get Started</a
      >
      <% }%>
    </section>

    <!-- Features Section -->
    <section class="features container">
      <h2>Why Blogify?</h2>
      <div class="row">
        <div class="col-md-4 feature-box">
          <div class="feature-icon">
            <i class="bi bi-pencil-square"></i>
          </div>
          <h5>Create and Publish</h5>
          <p>
            Write beautiful posts and publish them instantly to your followers
            and the world.
          </p>
        </div>
        <div class="col-md-4 feature-box">
          <div class="feature-icon">
            <i class="bi bi-chat-dots"></i>
          </div>
          <h5>Engage & Interact</h5>
          <p>
            Receive feedback, start discussions, and build your reader
            community.
          </p>
        </div>
        <div class="col-md-4 feature-box">
          <div class="feature-icon">
            <i class="bi bi-bar-chart-line"></i>
          </div>
          <h5>Track Your Growth</h5>
          <p>View stats and insights on how your blogs perform over time.</p>
        </div>
      </div>
    </section>

    <!-- Latest Blogs Section -->
    <section class="container my-5">
      <h2 class="text-center mb-5">Latest Blogs</h2>
      <div class="row">
        <% blogs.forEach(blog => { %>
        <div class="col-md-4 mb-4">
          <div class="card h-100 shadow-sm">
            <!-- Blog Image -->
            <div class="card-img-top" style="height: 300px; overflow: hidden">
              <img
                src="<%= blog.blogImageUrl %>"
                alt="<%= blog.title %>"
                class="w-100 h-100"
                style="object-fit: cover"
              />
            </div>

            <!-- Blog Content -->
            <div class="card-body d-flex flex-column justify-content-between">
              <div>
                <h5 class="card-title"><%= blog.title %></h5>
                <p class="card-text text-muted mb-2"><%= blog.category %></p>
              </div>
              <a
                href="/blogs/<%= blog._id %>"
                class="btn btn-primary btn-sm mt-2"
                >Read More</a
              >
            </div>

            <!-- Author Info -->
            <div
              class="card-footer bg-white d-flex align-items-center gap-2 border-top"
            >
              <img
                src="<%= blog.createdBy.profileImageUrl %>"
                alt="Author"
                class="rounded-circle"
                style="width: 40px; height: 40px; object-fit: cover"
              />
              <small class="text-muted"><%= blog.createdBy.fullName %></small>
            </div>

            <!-- Comment Form -->
            <div class="p-3 border-top">
              <h6 class="mb-2">Comment</h6>
              <form action="/comment/<%= blog._id %>" method="POST">
                <div class="mb-2">
                  <input
                    type="text"
                    name="content"
                    class="form-control form-control-sm"
                    placeholder="Write your comment..."
                    required
                  />
                </div>
                <button type="submit" class="btn btn-outline-primary btn-sm">
                  Post Comment
                </button>
              </form>

              <!-- Display Comments -->
              <% if (comments && comments.length > 0) { %>
              <div class="mt-3">
                <h6 class="text-muted">
                  Comments (<%= comments.length %>)
                </h6>
                <ul class="list-unstyled">
                  <% comments.forEach(comment => { %>
                  <li class="border rounded p-2 mb-2">
                    <div class="d-flex align-items-center gap-2 mb-1">
                      <img
                        src="<%= comment.createdBy?.profileImageUrl %>"
                        alt="User"
                        class="rounded-circle"
                        style="width: 30px; height: 30px; object-fit: cover"
                      />
                      <strong
                        ><%= comment.createdBy?.fullName || 'Unknown' %></strong
                      >
                    </div>
                    <p class="mb-0"><%= comment.content %></p>
                  </li>
                  <% }) %>
                </ul>
              </div>
              <% } else { %>
              <p class="text-muted mt-2">No comments yet.</p>
              <% } %>
            </div>
          </div>
        </div>
        <% }) %>
      </div>
    </section>

    <%- include('./partials/script') %>
  </body>
</html>
